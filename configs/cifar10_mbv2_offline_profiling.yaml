# configs/cifar10_mbv2_offline_profiling.yaml

experiment:
  name: cifar10_mbv2_offline_profiling
  output_dir: ./logs/cifar10_mbv2_offline_profiling

seed: 42

data:
  dataset: cifar10
  num_classes: 10
  img_size: 32
  train_val_split: [0.9, 0.1]
  num_workers: 4
  batch_size: 256
  bytes_per_elem: 4
  augmentation:
    random_crop: true
    random_crop_padding: 4
    random_horizontal_flip: true
    color_jitter: false
  iid: true

model:
  backbone: mobilenetv2
  pretrained: false
  in_channels: 3

usfl:
  mode: profiling
  num_clients: 5
  local_steps: 1
  aggregation: fedavg
  split:
    frontend_cut_range: [0, 5]
    backend_cut_range: [1, 6]

training:
  device: cuda
  epochs: 200
  mixed_precision: true
  grad_clip: 5.0
  eval_every: 1
  save_every: 10

simulation:
  comm:
    mode: fixed
    bw_up_mbps: 20.0
    bw_down_mbps: 20.0
    rtt_ms: 10.0
    temporal_corr: 0.0
    jitter_std: 0.0
  comp:
    kappa_client: 10
    kappa_server: 1

optimizer:
  type: sgd
  lr: 0.1
  momentum: 0.9
  weight_decay: 5e-4

metrics:
  average: macro
  multi_class: ovr

logging:
  log_interval: 10
  save_checkpoints: true
  tensorboard: true
  train_csv: train_metrics.csv
  val_csv: val_metrics.csv
  j_score_csv: j_scores.csv
  static_cost_csv: static_costs.csv
  feature_csv: features.csv
  scale_csv: scales.csv

privacy:
  # offline profiling 阶段你可以先不跑攻击（enabled=false），但把 aux 配好以便后续复用
  enabled: false
  aux_dataset:
    name: cifar10
    # 建议：aux 用 CIFAR-10 的“公开子集”，与 victim 训练数据做去重/不交叠
    split: train
    batch_size: 128
    num_workers: 4

objective:
  acc_mode: final
  weights:
    acc_cost: 1
    comm: 1
    comp: 1
    privacy: 1
  normalize_method: minmax
